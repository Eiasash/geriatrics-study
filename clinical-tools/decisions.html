<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinical Decision Support Tools - Geriatrics Fellowship</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tool-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .tool-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto p-6">
        <header class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">ü©∫ Clinical Decision Support Tools</h1>
                <p class="text-gray-600">Evidence-based tools for geriatric care decisions</p>
            </div>
            <button onclick="window.location.href='../index.html'" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                üè† Home
            </button>
        </header>

        <!-- Quick Decision Tools -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">

            <!-- Delirium Risk Assessment -->
            <div class="tool-card bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4 text-red-600">üß† Delirium Risk Stratification</h3>
                <div class="space-y-3">
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-points="1"> Age > 80 years
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-points="1"> Cognitive impairment
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-points="1"> Severe illness (APACHE > 16)
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-points="1"> Visual impairment
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-points="1"> Dehydration (BUN/Cr > 18)
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-points="1"> Infection present
                    </label>
                </div>
                <button onclick="calculateDeliriumRisk()" class="mt-4 w-full px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
                    Calculate Risk
                </button>
                <div id="deliriumResult" class="mt-4 p-3 bg-gray-100 rounded hidden"></div>
            </div>

            <!-- Polypharmacy Risk Tool -->
            <div class="tool-card bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4 text-purple-600">üíä Polypharmacy Risk Assessment</h3>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium mb-1">Number of medications:</label>
                        <input type="number" id="medCount" class="w-full p-2 border rounded" min="0" max="30">
                    </div>
                    <label class="flex items-center">
                        <input type="checkbox" id="highRiskMeds" class="mr-2"> High-risk medications (Beers)
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="renalImpair" class="mr-2"> Renal impairment
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="cognitiveImpair" class="mr-2"> Cognitive impairment
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="fallHistory" class="mr-2"> Fall in past year
                    </label>
                </div>
                <button onclick="assessPolypharmacy()" class="mt-4 w-full px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600">
                    Assess Risk
                </button>
                <div id="polypharmacyResult" class="mt-4 p-3 bg-gray-100 rounded hidden"></div>
            </div>

            <!-- Admission Decision Tool -->
            <div class="tool-card bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4 text-blue-600">üè• Admission vs Discharge Decision</h3>
                <div class="space-y-3">
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-admit="1"> Unstable vital signs
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-admit="1"> O2 sat < 92% on room air
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-admit="1"> New confusion/AMS
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-admit="1"> Unable to ambulate baseline
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-admit="1"> No caregiver at home
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" data-admit="1"> Failed oral intake
                    </label>
                </div>
                <button onclick="assessAdmission()" class="mt-4 w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                    Assess Disposition
                </button>
                <div id="admissionResult" class="mt-4 p-3 bg-gray-100 rounded hidden"></div>
            </div>

            <!-- Code Status Discussion Guide -->
            <div class="tool-card bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4 text-green-600">üí¨ Code Status Discussion Guide</h3>
                <div class="space-y-3">
                    <button onclick="showCodeStatusGuide()" class="w-full px-4 py-2 bg-green-100 text-green-700 rounded hover:bg-green-200">
                        Start Discussion Framework
                    </button>
                    <div id="codeStatusGuide" class="hidden space-y-2 text-sm">
                        <div class="p-2 bg-yellow-50 rounded">
                            <strong>1. Assess understanding:</strong><br>
                            "What is your understanding of your current medical condition?"
                        </div>
                        <div class="p-2 bg-yellow-50 rounded">
                            <strong>2. Explore values:</strong><br>
                            "What's most important to you in your life?"
                        </div>
                        <div class="p-2 bg-yellow-50 rounded">
                            <strong>3. Discuss prognosis:</strong><br>
                            "Would you like to know what to expect?"
                        </div>
                        <div class="p-2 bg-yellow-50 rounded">
                            <strong>4. Present options:</strong><br>
                            "Let me explain what different levels of care mean..."
                        </div>
                        <div class="p-2 bg-yellow-50 rounded">
                            <strong>5. Make recommendation:</strong><br>
                            "Based on what you've told me, I recommend..."
                        </div>
                    </div>
                </div>
            </div>

            <!-- Capacity Assessment Checklist -->
            <div class="tool-card bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4 text-orange-600">üß© Capacity Assessment Tool</h3>
                <div class="space-y-3">
                    <h4 class="font-semibold">Four Elements:</h4>
                    <label class="flex items-center">
                        <input type="checkbox" class="capacity-check mr-2"> Understands relevant information
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="capacity-check mr-2"> Appreciates situation & consequences
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="capacity-check mr-2"> Can reason through options
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="capacity-check mr-2"> Can express a choice clearly
                    </label>
                </div>
                <button onclick="assessCapacity()" class="mt-4 w-full px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600">
                    Evaluate Capacity
                </button>
                <div id="capacityResult" class="mt-4 p-3 bg-gray-100 rounded hidden"></div>
            </div>

            <!-- Antibiotic Decision Tool -->
            <div class="tool-card bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4 text-indigo-600">ü¶† UTI Treatment Decision</h3>
                <div class="space-y-3">
                    <h4 class="font-semibold">Symptoms:</h4>
                    <label class="flex items-center">
                        <input type="checkbox" class="uti-symptom mr-2"> Dysuria
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="uti-symptom mr-2"> Increased frequency
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="uti-symptom mr-2"> Suprapubic pain
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="uti-symptom mr-2"> New incontinence
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="uti-risk mr-2"> Fever > 38¬∞C
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="uti-risk mr-2"> Cognitive change from baseline
                    </label>
                </div>
                <button onclick="assessUTI()" class="mt-4 w-full px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600">
                    Assess Need for Treatment
                </button>
                <div id="utiResult" class="mt-4 p-3 bg-gray-100 rounded hidden"></div>
            </div>
        </div>

        <!-- Quick Reference Protocols -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-4">‚ö° Quick Reference Protocols</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="p-4 bg-blue-50 rounded">
                    <h3 class="font-bold text-blue-900 mb-2">Hyponatremia Workup</h3>
                    <ol class="text-sm space-y-1">
                        <li>1. Check volume status (orthostatics, JVP, edema)</li>
                        <li>2. Order: Serum osm, urine osm, urine Na</li>
                        <li>3. If euvolemic + urine osm >100: Consider SIADH</li>
                        <li>4. Fluid restrict if SIADH (500-1000ml/day)</li>
                        <li>5. Correct slowly: Max 8-10 mEq/L in 24h</li>
                    </ol>
                </div>
                <div class="p-4 bg-green-50 rounded">
                    <h3 class="font-bold text-green-900 mb-2">Acute Confusion Protocol</h3>
                    <ol class="text-sm space-y-1">
                        <li>1. ABCs, glucose, O2 sat</li>
                        <li>2. Review meds (anticholinergics, benzos, opioids)</li>
                        <li>3. Check: CBC, BMP, LFTs, TSH, UA, CXR</li>
                        <li>4. CAM assessment for delirium</li>
                        <li>5. Non-pharm: Orient, mobilize, sleep hygiene</li>
                    </ol>
                </div>
                <div class="p-4 bg-red-50 rounded">
                    <h3 class="font-bold text-red-900 mb-2">Fall Assessment</h3>
                    <ol class="text-sm space-y-1">
                        <li>1. Check for injury (head, hip, spine)</li>
                        <li>2. Orthostatic vitals</li>
                        <li>3. Review medications (>4 = high risk)</li>
                        <li>4. Gait assessment (TUG test)</li>
                        <li>5. Vision/hearing check</li>
                    </ol>
                </div>
                <div class="p-4 bg-purple-50 rounded">
                    <h3 class="font-bold text-purple-900 mb-2">Constipation Management</h3>
                    <ol class="text-sm space-y-1">
                        <li>1. R/O obstruction (KUB if concern)</li>
                        <li>2. Start: PEG 17g daily</li>
                        <li>3. Add: Senna 2 tabs QHS</li>
                        <li>4. If no BM x3 days: Bisacodyl supp</li>
                        <li>5. Severe: Consider lactulose or enema</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script>
        function calculateDeliriumRisk() {
            const checkboxes = document.querySelectorAll('[data-points]');
            let score = 0;
            checkboxes.forEach(cb => {
                if (cb.checked) score += parseInt(cb.dataset.points);
            });

            const resultDiv = document.getElementById('deliriumResult');
            let risk = '';
            let recommendation = '';

            if (score <= 1) {
                risk = 'LOW RISK (10-15%)';
                recommendation = 'Standard precautions';
            } else if (score <= 3) {
                risk = 'MODERATE RISK (25-35%)';
                recommendation = 'Enhanced monitoring, orientation protocol';
            } else {
                risk = 'HIGH RISK (>50%)';
                recommendation = 'Intensive delirium prevention bundle:\n- Frequent orientation\n- Early mobilization\n- Sleep protocol\n- Avoid restraints\n- Minimize sedatives';
            }

            resultDiv.innerHTML = `
                <strong>Risk Level: ${risk}</strong><br>
                <strong>Score: ${score}/6</strong><br>
                <strong>Recommendations:</strong><br>
                <div class="mt-2 text-sm">${recommendation.replace(/\n/g, '<br>')}</div>
            `;
            resultDiv.classList.remove('hidden');
        }

        function assessPolypharmacy() {
            const medCount = parseInt(document.getElementById('medCount').value) || 0;
            const highRisk = document.getElementById('highRiskMeds').checked;
            const renal = document.getElementById('renalImpair').checked;
            const cognitive = document.getElementById('cognitiveImpair').checked;
            const falls = document.getElementById('fallHistory').checked;

            let risk = 'LOW';
            let actions = [];

            if (medCount >= 10 || (medCount >= 5 && (highRisk || renal || cognitive || falls))) {
                risk = 'HIGH';
                actions = [
                    '‚Ä¢ Comprehensive medication review urgently needed',
                    '‚Ä¢ Consider deprescribing non-essential meds',
                    '‚Ä¢ Check for drug-drug interactions',
                    '‚Ä¢ Assess adherence barriers',
                    '‚Ä¢ Consider pharmacy consult'
                ];
            } else if (medCount >= 5) {
                risk = 'MODERATE';
                actions = [
                    '‚Ä¢ Schedule medication review',
                    '‚Ä¢ Verify indications for each med',
                    '‚Ä¢ Check dosing appropriateness'
                ];
            } else {
                actions = ['‚Ä¢ Continue current regimen', '‚Ä¢ Review at next visit'];
            }

            const resultDiv = document.getElementById('polypharmacyResult');
            resultDiv.innerHTML = `
                <strong>Polypharmacy Risk: ${risk}</strong><br>
                <strong>Action Items:</strong><br>
                <div class="mt-2 text-sm">${actions.join('<br>')}</div>
            `;
            resultDiv.classList.remove('hidden');
        }

        function assessAdmission() {
            const admitChecks = document.querySelectorAll('[data-admit]');
            let admitCount = 0;
            admitChecks.forEach(cb => {
                if (cb.checked) admitCount++;
            });

            const resultDiv = document.getElementById('admissionResult');
            let disposition = '';
            let rationale = '';

            if (admitCount >= 2) {
                disposition = 'üè• RECOMMEND ADMISSION';
                rationale = `${admitCount} high-risk criteria met. Patient needs inpatient monitoring and treatment.`;
            } else if (admitCount === 1) {
                disposition = 'üè† CONSIDER OBS/HOME';
                rationale = 'Single criterion - evaluate social support and follow-up capabilities.';
            } else {
                disposition = 'üè† SAFE FOR DISCHARGE';
                rationale = 'No high-risk features. Ensure follow-up within 48-72 hours.';
            }

            resultDiv.innerHTML = `
                <strong>${disposition}</strong><br>
                <div class="mt-2 text-sm">${rationale}</div>
            `;
            resultDiv.classList.remove('hidden');
        }

        function showCodeStatusGuide() {
            const guide = document.getElementById('codeStatusGuide');
            guide.classList.toggle('hidden');
        }

        function assessCapacity() {
            const checks = document.querySelectorAll('.capacity-check');
            let metCriteria = 0;
            checks.forEach(cb => {
                if (cb.checked) metCriteria++;
            });

            const resultDiv = document.getElementById('capacityResult');
            let assessment = '';
            let next = '';

            if (metCriteria === 4) {
                assessment = '‚úÖ HAS CAPACITY';
                next = 'Patient can make this decision. Document thoroughly.';
            } else if (metCriteria >= 2) {
                assessment = '‚ö†Ô∏è PARTIAL CAPACITY';
                next = 'Consider psychiatry consult. May have capacity for some decisions but not others.';
            } else {
                assessment = '‚ùå LACKS CAPACITY';
                next = 'Identify surrogate decision maker. Consider psychiatric evaluation if reversible causes.';
            }

            resultDiv.innerHTML = `
                <strong>${assessment}</strong><br>
                <strong>Criteria met: ${metCriteria}/4</strong><br>
                <div class="mt-2 text-sm">${next}</div>
            `;
            resultDiv.classList.remove('hidden');
        }

        function assessUTI() {
            const symptoms = document.querySelectorAll('.uti-symptom:checked').length;
            const risks = document.querySelectorAll('.uti-risk:checked').length;

            const resultDiv = document.getElementById('utiResult');
            let recommendation = '';
            let treatment = '';

            if (symptoms >= 2 || (symptoms >= 1 && risks >= 1)) {
                recommendation = 'üíä TREAT UTI';
                treatment = `
                    <strong>First-line:</strong> Nitrofurantoin 100mg BID x5 days<br>
                    <strong>If CrCl <30:</strong> Cephalexin 500mg BID x7 days<br>
                    <strong>If fever/systemic:</strong> Ceftriaxone 1g IV/IM x1, then PO
                `;
            } else if (symptoms === 0 && risks === 0) {
                recommendation = 'üö´ DO NOT TREAT';
                treatment = 'Asymptomatic bacteriuria - no treatment needed in non-pregnant patients';
            } else {
                recommendation = 'üîç MONITOR CLOSELY';
                treatment = 'Consider UA/UCx. Reassess in 24h. Hydration and hygiene measures.';
            }

            resultDiv.innerHTML = `
                <strong>${recommendation}</strong><br>
                <div class="mt-2 text-sm">${treatment}</div>
            `;
            resultDiv.classList.remove('hidden');
        }
    </script>
</body>
</html>
